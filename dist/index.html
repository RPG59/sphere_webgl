<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>

<canvas width="1024" height="768" id="3D"></canvas>

<script type="x-shader/x-vertex" id="vs">#version 300 es
    layout(location=0) in vec3 a_position;
    layout(location=1) in vec3 a_normal;

    out vec3 FragPos;
    out vec3 Normal;
    out vec3 N;
    out vec3 V;

    uniform mat4 u_viewMatrix;
    uniform mat4 u_projMatrix;
    uniform mat4 u_modelMatrix;

    void main() {
        gl_Position = u_projMatrix * u_viewMatrix * u_modelMatrix * vec4(a_position, 1.);
        FragPos = vec3(u_modelMatrix * vec4(a_position, 1.0));
        Normal = a_normal;
        N = mat3(u_viewMatrix) * a_normal;
        V = -mat3(u_modelMatrix) * a_position;
    }
</script>
<script type="x-shader/x-fragment" id="fs">#version 300 es
    precision lowp float;

    in vec3 Normal;
    in vec3 FragPos;
    in vec3 N;
    in vec3 V;

    out vec4 FragColor;

    uniform vec3 objectColor;
    uniform vec3 lightColor;
    uniform vec3 lightPos;
    uniform vec3 viewPos;

    void main() {
        float ambientStrength = 0.1;
        vec3 ambientLight = lightColor * ambientStrength;   

        vec3 norm = normalize(Normal);
        vec3 lightDir = normalize(lightPos - FragPos);
        float diff = max(dot(norm, lightDir), 0.0);
        vec3 diffuse = diff * lightColor;

        float specularStrength = .5;
        vec3 viewDir = normalize(viewPos - FragPos);
        vec3 reflectDir = reflect(-lightDir, norm);  
        float spec = pow(max(dot(viewDir, reflectDir), 0.0), 128.);
        vec3 specular = specularStrength * spec * lightColor; 

        vec3 result = (ambientLight + diffuse + specular) * objectColor;




        FragColor = vec4(result, 1.);
    }
</script>

<script type="x-shader/x-vertex" id="vs_lighting">#version 300 es
    layout(location=0) in vec4 a_position;

    uniform mat4 u_viewMatrix;
    uniform mat4 u_projMatrix;
    uniform mat4 u_modelMatrix;

    void main() {
        gl_Position = u_projMatrix * u_viewMatrix * u_modelMatrix * a_position;
    }
</script>

<script type="x-shader/x-fragment" id="fs_lighting">#version 300 es
    precision lowp float;
    out vec4 FragColor;

    void main() {
        FragColor = vec4(1.);
    }
</script>


<script>
    gl = null;
    const canvas = document.getElementById('3D');

    try {
        gl = canvas.getContext('webgl2');
    } catch (e) {
        console.log('webGL2 is not ok!');
    }
</script>
<script src="./bundle.js"></script>
</body>


</html>
